<h1 class="text-center mt-4">Cadastro de Cliente</h1>
<div class="mt-4">
    <button mat-fab extended color="primary" [routerLink]="['/']">
        <mat-icon>arrow_back</mat-icon>
        Voltar
    </button>
    <div class="mt-4">
        <form [formGroup]="formCadastro">
            <div class="row mt-4">
                <div class="col-6">
                    <label for="nomeCliente"
                        [ngClass]="formCadastro.get('name')?.invalid && formCadastro.get('name')?.touched ? 'text-color-error' : ''">Nome</label>
                    <mat-form-field appearance="outline" class="w-100">
                        <input formControlName="name" matInput placeholder="Nome do cliente" id="nomeCliente">
                        <mat-error *ngIf="formCadastro.get('name')?.invalid">
                            <span>Nome do cliente é obrigatório</span>
                        </mat-error>
                    </mat-form-field>
                </div>
                <div class="col-6">
                    <label for="emailCliente"
                        [ngClass]="formCadastro.get('email')?.invalid && formCadastro.get('email')?.touched ? 'text-color-error' : ''">Email</label>
                    <mat-form-field appearance="outline" class="w-100">
                        <input type="email" formControlName="email" matInput placeholder="Ex. cli@example.com"
                            id="emailCliente">
                        <mat-error *ngIf="formCadastro.get('email')?.invalid">
                            <span *ngIf="formCadastro.get('email')?.errors?.['required']" >Email do cliente é obrigatório</span>
                            <span *ngIf="formCadastro.get('email')?.errors?.['email']" >Email deve ser válido</span> 
                        </mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-6">
                    <label for="dataNascimento"
                        [ngClass]="formCadastro.get('birthday')?.invalid && formCadastro.get('birthday')?.touched ? 'text-color-error' : ''">Data
                        de nascimento</label>
                    <mat-form-field appearance="outline" class="w-100">
                        <input type="date" formControlName="birthday" matInput
                            placeholder="dataNascimento do cliente" id="dataNascimento">
                        <mat-error *ngIf="formCadastro.get('birthday')?.invalid">
                            <span>Data de nascimento do cliente é obrigatório</span>
                        </mat-error>
                    </mat-form-field>
                </div>
                <div class="col-6">
                    <label for="cpfCliente"
                        [ngClass]="formCadastro.get('cpf')?.invalid && formCadastro.get('cpf')?.touched ? 'text-color-error' : ''">CPF</label>
                    <mat-form-field appearance="outline" class="w-100">
                        <input type="text" formControlName="cpf" matInput id="cpfCliente" placeholder="CPF do cliente">
                        <mat-error *ngIf="formCadastro.get('cpf')?.invalid">
                            <span>CPF do cliente é obrigatório</span>
                        </mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-6">
                    <label for="telefoneCliente"
                        [ngClass]="formCadastro.get('telephone')?.invalid && formCadastro.get('telephone')?.touched ? 'text-color-error' : ''">Telefone</label>
                    <mat-form-field appearance="outline" class="w-100">
                        <input type="tel" formControlName="telephone" matInput placeholder="telefone do cliente"
                            id="telefoneCliente">
                        <mat-error *ngIf="formCadastro.get('telephone')?.invalid">
                            <span>Telefone do cliente é obrigatório</span>
                        </mat-error>
                    </mat-form-field>
                </div>
                <div class="col-6">
                    <label for="sexoCliente"
                        [ngClass]="formCadastro.get('gender')?.invalid && formCadastro.get('gender')?.touched ? 'text-color-error' : ''">sexo</label>
                    <mat-form-field appearance="outline" class="w-100">
                        <mat-select formControlName="gender" id="sexoCliente">
                            <mat-option value="MASCULINO">Masculino</mat-option>
                            <mat-option value="FEMININO">Feminino</mat-option>
                        </mat-select>
                        <mat-error *ngIf="formCadastro.get('gender')?.invalid">
                            <span>Sexo do cliente é obrigatório</span>
                        </mat-error>
                    </mat-form-field>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-6">
                    <label for="medicamentosEmUsoCliente"
                        [ngClass]="formCadastro.get('medicinesInUse')?.invalid && formCadastro.get('medicinesInUse')?.touched ? 'text-color-error' : ''">Medicamentos</label>
                    <mat-form-field appearance="outline" class="w-100">
                        <textarea formControlName="medicinesInUse" rows="1" matInput
                            placeholder="Medicamentos em uso do cliente" id="medicamentosEmUsoCliente"></textarea>
                    </mat-form-field>
                </div>
                <div class="col-6">
                    <label for="grauEscolaridadeCliente"
                        [ngClass]="formCadastro.get('educationLevel')?.invalid && formCadastro.get('educationLevel')?.touched ? 'text-color-error' : ''">Grau
                        de Escolaridade</label>
                    <mat-form-field appearance="outline" class="w-100">
                        <input type="text" formControlName="educationLevel" id="grauEscolaridadeCliente" matInput
                            placeholder="Grau de Escolaridade do cliente">
                    </mat-form-field>
                </div>
            </div>
            <div class="row mt-4">
                <div class="col-12">
                    <label for="dadosTratamentoCliente"
                        [ngClass]="formCadastro.get('processingInformation')?.invalid && formCadastro.get('processingInformation')?.touched ? 'text-color-error' : ''">Dados do
                        Tratamento</label>
                    <mat-form-field appearance="outline" class="w-100">
                        <textarea formControlName="processingInformation" rows="10" matInput
                            placeholder="Dados Tratamento do cliente" id="dadosTratamentoCliente"></textarea>
                    </mat-form-field>
                </div>
            </div>
            <div class="row mt-4" formGroupName="address">
                <h2>Endereço:</h2>
                <div class="row mt-4">
                    <div class="col-6">
                        <label for="ruaCliente" [ngClass]="formCadastro.get('address')?.get('street')?.invalid && formCadastro.get('address')?.get('street')?.touched ? 'text-color-error' : ''">Rua</label>
                        <mat-form-field appearance="outline" class="w-100">
                            <input type="text" formControlName="street" matInput placeholder="Rua do cliente"
                                id="ruaCliente">
                            <mat-error *ngIf="formCadastro.get('address')?.get('street')?.invalid">
                                <span>Rua do cliente é obrigatório</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-6">
                        <label for="cepCliente" [ngClass]="formCadastro.get('address')?.get('cep')?.invalid && formCadastro.get('address')?.get('cep')?.touched ? 'text-color-error' : ''">CEP</label>
                        <mat-form-field appearance="outline" class="w-100">
                            <input type="text" formControlName="cep" matInput placeholder="cep do cliente"
                                id="cepCliente">
                            <mat-error *ngIf="formCadastro.get('address')?.get('cep')?.invalid">
                                <span>Cep do cliente é obrigatório</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-6">
                        <label for="numeroCliente" [ngClass]="formCadastro.get('address')?.get('addressNumber')?.invalid && formCadastro.get('address')?.get('addressNumber')?.touched ? 'text-color-error' : ''">Número</label>
                        <mat-form-field appearance="outline" class="w-100">
                            <input type="number" formControlName="addressNumber" matInput placeholder="Número endereço do cliente"
                                id="numeroCliente">
                            <mat-error *ngIf="formCadastro.get('address')?.get('addressNumber')?.invalid">
                                <span>Número endereço do cliente é obrigatório</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-6">
                        <label for="complementoCliente" [ngClass]="formCadastro.get('address')?.get('complement')?.invalid && formCadastro.get('address')?.get('complement')?.touched ? 'text-color-error' : ''">Complemento</label>
                        <mat-form-field appearance="outline" class="w-100">
                            <input type="text" formControlName="complement" matInput
                                placeholder="Complemento do cliente" id="complementoCliente">
                        </mat-form-field>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-6">
                        <label for="bairroCliente" [ngClass]="formCadastro.get('address')?.get('neighborhood')?.invalid && formCadastro.get('address')?.get('neighborhood')?.touched ? 'text-color-error' : ''">Bairro</label>
                        <mat-form-field appearance="outline" class="w-100">
                            <input type="text" formControlName="neighborhood" matInput placeholder="Bairro do cliente"
                                id="bairroCliente">
                            <mat-error *ngIf="formCadastro.get('address')?.get('neighborhood')?.invalid">
                                <span>Bairro do cliente é obrigatório</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                    <div class="col-6">
                        <label for="cidadeCliente" [ngClass]="formCadastro.get('address')?.get('city')?.invalid && formCadastro.get('address')?.get('city')?.touched ? 'text-color-error' : ''">Cidade</label>
                        <mat-form-field appearance="outline" class="w-100">
                            <input type="text" formControlName="city" matInput placeholder="Cidade do cliente"
                                id="cidadeCliente">
                            <mat-error *ngIf="formCadastro.get('address')?.get('city')?.invalid">
                                <span>Cidade do cliente é obrigatório</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-6">
                        <label for="estadoCliente" [ngClass]="formCadastro.get('address')?.get('state')?.invalid && formCadastro.get('address')?.get('state')?.touched ? 'text-color-error' : ''">Estado</label>
                        <mat-form-field appearance="outline" class="w-100">
                            <input type="text" formControlName="state" matInput placeholder="Estado do cliente"
                                id="estadoCliente">
                            <mat-error *ngIf="formCadastro.get('address')?.get('state')?.invalid">
                                <span>Estado do cliente é obrigatório</span>
                            </mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </div>

            <div class="row mt-4" *ngIf="cliente?.responsible && cliente?.responsible!.length > 0">
                <h2>Responsáveis Cadastrados</h2>
                <app-expansion-panel-responsavel 
                    [responsaveis]="cliente?.responsible"
                    (acessarEvent)="addResponsavel($event)"
                    (removerEvent)="removeResponsavel($event)"
                ></app-expansion-panel-responsavel>
            </div>

            <div class="d-flex justify-content-between mt-4 mb-5">
                <button mat-fab extended color="primary" (click)="addResponsavel()">Adicionar Responsável</button>
                <button mat-fab extended color="primary" [disabled]="formCadastro.invalid"
                    (click)="save()">Cadastrar</button>
            </div>
        </form>
    </div>
</div>